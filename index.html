<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content="#1f1f27">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="mobile-web-app-capable" content="yes">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <title>ILLIT</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="shortcut icon" href="./logo.svg" type="image/svg+xml">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    /* for iOS */
    :root {
      --sat: env(safe-area-inset-top);
      --sab: env(safe-area-inset-bottom);
      --sar: env(safe-area-inset-right);
      --sal: env(safe-area-inset-left);
      --vh: 1vh; /* fallback JS */
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #1a0933;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(20px);
      color: #fff;
      overflow-x: hidden;
      position: relative;
    }

    body {
      min-height: calc(100dvh + env(safe-area-inset-top) + env(safe-area-inset-bottom));
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      box-sizing: border-box;
      background: linear-gradient(135deg, #1a0933, #3c1a6d);
      color: #fff; 
    }

    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
      pointer-events: none;
    }
    
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px;
    }
    
    header {
      text-align: center;
      padding: 20px 0;
      margin-bottom: 30px;
      position: relative;
    }

    .logo {
      font-family: 'Montserrat', sans-serif;
      font-size: 3.5rem;
      font-weight: 700;
      background: linear-gradient(45deg, #ff6ec4, #7873f5);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(120, 115, 245, 0.3);
      margin-bottom: 10px;
    }
    
    .subtitle {
      font-size: 1.2rem;
      color: #d0cde7;
      margin-bottom: 30px;
    }
    
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 10px;
    }
    
    .tab-btn {
      background: none;
      border: none;
      color: #a29ebd;
      font-size: 1.1rem;
      font-weight: 500;
      padding: 10px 25px;
      margin: 0 10px;
      cursor: pointer;
      border-radius: 30px;
      transition: all 0.3s ease;
      position: relative;
      outline: none;
    }
    
    .tab-btn.active {
      color: #fff;
      background: rgba(120, 115, 245, 0.2);
    }
    
    .tab-btn::after {
      content: '';
      position: absolute;
      bottom: -12px;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, #ff6ec4, #7873f5);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    .tab-btn.active::after {
      transform: scaleX(1);
    }
    
    .tab-content {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    
    .tab-content.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .wrapper {
      background: rgba(30, 20, 60, 0.7);
      backdrop-filter: blur(8px);
      border-radius: 25px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
      max-width: 450px;
      margin: 0 auto;
      padding: 25px;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
      min-height: auto;
    }
    
    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 25px;
      color: #d0cde7;
    }
    
    .top-bar i {
      font-size: 24px;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    
    .top-bar i:hover {
      color: #ff6ec4;
    }
    
    .top-bar span {
      font-weight: 500;
    }
    
    .img-area {
      width: 300px;
      height: 300px;
      margin: 0 auto 25px;
      border-radius: 50%;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      border: 5px solid rgba(255, 255, 255, 0.1);
      position: relative;
      animation: rotateAlbum 20s linear infinite;
      animation-play-state: paused;
    }
    
    .wrapper.playing .img-area {
      animation-play-state: running;
    }
    
    @keyframes rotateAlbum {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .img-area img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .song-details {
      text-align: center;
      margin-bottom: 25px;
    }
    
    .song-details .name {
      font-size: 1.8rem;
      font-weight: 600;
      margin-bottom: 5px;
      color: #fff;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .song-details .artist {
      font-size: 1.2rem;
      color: #a29ebd;
    }

    .progress-area {
      height: 6px;
      width: 100%;
      border-radius: 50px;
      background: #f0f0f0;
      cursor: pointer;
    }
    .progress-area .progress-bar {
      height: inherit;
      width: 0%;
      position: relative;
      border-radius: inherit;
      background: #df73b3;
    }
    .progress-bar::before {
      content: "";
      position: absolute;
      height: 12px;
      width: 12px;
      border-radius: 50%;
      top: 50%;
      right: -5px;
      z-index: 2;
      opacity: 0;
      pointer-events: none;
      transform: translateY(-50%);
      background: inherit;
      transition: opacity 0.2s ease;
    }
    .progress-area:hover .progress-bar::before {
      opacity: 1;
      pointer-events: none;
    }
    .progress-area .song-timer {
      margin-top: 2px;
    }
    .song-timer span {
      margin-top: 10px;
      font-size: 13px;
      color: var(--lightback);
    }
    
    .controls {
      margin-top: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }
    
    .controls i {
      font-size: 28px;
      margin: 0 15px;
      cursor: pointer;
      color: #d0cde7;
      transition: all 0.3s ease;
    }
    
    .controls i:hover {
      color: #ff6ec4;
      transform: scale(1.1);
    }
    
    .play-pause {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6ec4, #7873f5);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 5px 20px rgba(120, 115, 245, 0.4);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .play-pause:hover {
      transform: scale(1.05);
      box-shadow: 0 7px 25px rgba(120, 115, 245, 0.6);
    }
    
    .play-pause i {
      color: #fff;
      font-size: 32px;
      margin: 0;
    }
    
    .music-list {
      position: absolute;
      background: rgba(42, 36, 63, 0.5);
      backdrop-filter: blur(10px);
      width: 100%;
      top: 0;
      left: 0;
      border-radius: 25px;
      padding: 25px;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      z-index: 10;
      overflow-y: auto;
      max-height: 100%;
    }
    
    .music-list.show {
      transform: translateX(0);
    }
    
    .music-list .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 25px;
    }
    
    .music-list .header .row {
      display: flex;
      align-items: center;
    }
    
    .music-list .header .row i {
      font-size: 24px;
      color: #ff6ec4;
      margin-right: 10px;
    }
    
    .music-list .header .row span {
      font-size: 1.2rem;
      font-weight: 500;
    }
    
    .music-list #close {
      font-size: 24px;
      color: #d0cde7;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    
    .music-list #close:hover {
      color: #ff6ec4;
    }
    
    .music-list ul {
      list-style: none;
      max-height: 100%;
      overflow-y: auto;
      scroll-behavior: smooth;
    }
    
    .music-list ul li {
      display: flex;
      align-items: center;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    
    .music-list ul li:hover {
      background: rgba(120, 115, 245, 0.2);
    }
    
    .music-list ul li.playing {
      background: rgba(120, 115, 245, 0.3);
      border-left: 4px solid #ff6ec4;
    }
    
    .music-list ul li .row {
      display: flex;
      align-items: center;
      width: 100%;
    }
    
    .music-list ul li .row .details {
      margin-left: 15px;
      flex: 1;
    }
    
    .music-list ul li .row .details .name {
      font-size: 1.1rem;
      font-weight: 500;
      margin-bottom: 5px;
    }
    
    .music-list ul li .row .details .artist {
      font-size: 0.9rem;
      color: #a29ebd;
    }
    
    .music-list ul li .audio-duration {
      font-size: 0.9rem;
      color: #a29ebd;
    }
    
    .info-tab {
      background: rgba(30, 20, 60, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 25px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
      padding: 30px;
      max-width: 900px;
      margin: 0 auto;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .group-info {
      margin-bottom: 40px;
    }
    
    .group-info h2 {
      font-size: 2rem;
      margin-bottom: 20px;
      color: #ff6ec4;
      text-align: center;
      position: relative;
      padding-bottom: 15px;
    }
    
    .group-info h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, #ff6ec4, #7873f5);
      border-radius: 3px;
    }
    
    .group-info p {
      font-size: 1.1rem;
      line-height: 1.8;
      margin-bottom: 15px;
      color: #d0cde7;
      text-align: justify;
    }
    
    .members {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }
    
    .member-card {
      background: rgba(40, 30, 80, 0.5);
      border-radius: 15px;
      overflow: hidden;
      text-align: center;
      transition: transform 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .member-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 25px rgba(120, 115, 245, 0.4);
    }
    
    .member-img {
      height: 200px;
      width: 100%;
      background: linear-gradient(45deg, #3c1a6d, #1a0933);
      position: relative;
      overflow: hidden;
    }
    
    .member-img::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, rgba(255, 110, 196, 0.1), rgba(120, 115, 245, 0.1));
    }
    
    .member-img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }
    
    .member-card:hover .member-img img {
      transform: scale(1.1);
    }
    
    .member-info {
      padding: 15px;
    }
    
    .member-info h3 {
      font-size: 1.3rem;
      margin-bottom: 5px;
      color: #fff;
    }
    
    .member-info .position {
      color: #ff6ec4;
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    
    .member-info .birthdate {
      color: #a29ebd;
      font-size: 0.9rem;
    }
    
    .designer-info {
      background: rgba(40, 30, 80, 0.5);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .designer-info h2 {
      font-size: 1.8rem;
      margin-bottom: 15px;
      color: #7873f5;
    }
    
    .designer-info p {
      font-size: 1.1rem;
      color: #d0cde7;
      margin-bottom: 10px;
    }
    
    /* PWA Install Button */
    .install-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(45deg, #ff6ec4, #7873f5);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(120, 115, 245, 0.5);
      z-index: 1000;
      display: none;
      transition: all 0.3s ease;
    }
    
    .install-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(120, 115, 245, 0.7);
    }
    
    .install-btn i {
      margin-right: 8px;
    }
    
    /* iOS PWA Splash Screen */
    #ios-splash {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1a0933, #3c1a6d);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 10000;
      transition: opacity 0.5s ease;
    }
    
    #ios-splash.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    #ios-splash .logo {
      font-size: 4rem;
      margin-bottom: 20px;
    }
    
    #ios-splash .splash-text {
      font-size: 1.5rem;
      color: #d0cde7;
      text-align: center;
      max-width: 80%;
      margin-top: 20px;
    }
    
    #ios-splash .splash-subtext {
      font-size: 1rem;
      color: #a29ebd;
      margin-top: 30px;
      text-align: center;
      max-width: 80%;
    }
    
    #ios-splash .tap-to-start {
      position: absolute;
      bottom: 50px;
      font-size: 1.2rem;
      color: #ff6ec4;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 0.5; }
      50% { opacity: 1; }
      100% { opacity: 0.5; }
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .logo {
        font-size: 2.5rem;
      }
      
      .wrapper {
        max-width: 100%;
      }
      
      .img-area {
        width: 250px;
        height: 250px;
      }
      
      .members {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }
      
      .member-img {
        height: 170px;
      }
    }
    
    @media (max-width: 480px) {
      .logo {
        font-size: 2rem;
      }
      
      .subtitle {
        font-size: 1rem;
      }
      
      .img-area {
        width: 200px;
        height: 200px;
      }
      
      .controls i {
        margin: 0 10px;
      }
      
      .play-pause {
        width: 50px;
        height: 50px;
      }
      
      .play-pause i {
        font-size: 28px;
      }
      
      .install-btn {
        bottom: 70px;
        padding: 10px 20px;
        font-size: 14px;
      }
    }
    

    
  
  </style>
</head>
<body>

  <!-- iOS PWA Splash Screen -->
  <div id="ios-splash">
    <h1 class="logo">ILLIT</h1>
    <p class="splash-text">Trình phát nhạc chính thức của ILLIT</p>
    <p class="splash-subtext">Để có trải nghiệm tốt nhất, hãy thêm ứng dụng vào màn hình chính</p>
    <p class="tap-to-start">Chạm để bắt đầu</p>
  </div>
  
  <!-- Install Button -->
  <button id="install-btn" class="install-btn">
    <i class="material-icons">add_to_home_screen</i>
    Thêm vào màn hình chính
  </button>
  
  <!-- Hiệu ứng hạt -->
  <div id="particles-js"></div>
  
  <div class="container">
    <header>
      <h1 class="logo">ILLIT</h1>
      <p class="subtitle">Music Player</p>
      <p class="beta">Hiện đang trong quá trình thử nghiệm sẽ có 1 lỗi số sẽ xảy ra</p>
    </header>
    
    <div class="tabs">
      <button class="tab-btn active" data-tab="player">Music Player</button>
      <button class="tab-btn" data-tab="info">Thông tin nhóm</button>
    </div>
    
    <!-- Player Tab -->
    <div id="player-tab" class="tab-content active">
      <div class="wrapper">
        <div class="top-bar">
          <i class="material-icons">expand_more</i>
          <span>Đang phát bài</span>
          <i class="material-icons">more_horiz</i>
        </div>

        <div class="img-area">
          <img src="" alt="">
        </div>

        <div class="song-details">
          <p class="name"></p>
          <p class="artist"></p>
        </div>

        <div class="progress-area">
          <div class="progress-bar">
            <audio src="" id="main-audio"></audio>
            <div class="progress"></div>
          </div>
          <div class="song-timer">
            <span class="current-time">0:00</span>
            <span class="max-duration">1:00</span>
          </div>
        </div>

        <div class="controls">
          <i id="repeat-plist" class="material-icons" title="Playlist looped">repeat</i>
          <i id="prev" class="material-icons" >skip_previous</i>
          <div class="play-pause">
            <i class="material-icons play" >play_arrow</i>
          </div>
          <i id="next" class="material-icons" >skip_next</i>
          <i id="more-music" class="material-icons" >queue_music</i>
        </div>
        
       
        <div class="music-list">
          <div class="header">
            <div class="row">
              <i class="list material-icons">queue_music</i>
              <span>Danh sách bài hát</span>
            </div>
            <i id="close" class="material-icons">close</i>
          </div>
          <ul>
            <!-- Danh sách bài hát sẽ được tải động -->
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Info Tab -->
    <div id="info-tab" class="tab-content">
      <div class="info-tab">
        <div class="group-info">
          <h2>Thông tin nhóm ILLIT</h2>
          <p>ILLIT là nhóm nhạc nữ Hàn Quốc được thành lập bởi BELIFT LAB, một liên doanh giữa HYBE và CJ ENM. Nhóm ra mắt vào tháng 3 năm 2024 với mini-album đầu tay "SUPER REAL ME".</p>
          <p>ILLIT nổi tiếng với phong cách âm nhạc tươi mới, trẻ trung kết hợp với hình ảnh độc đáo và đầy cá tính. Bài hát "Magnetic" đã nhanh chóng trở thành hit trên các bảng xếp hạng âm nhạc toàn cầu.</p>
          <p>Với sự kết hợp hoàn hảo giữa giọng hát, vũ đạo sáng tạo và hình ảnh đẹp mắt, ILLIT đang nhanh chóng trở thành một trong những nhóm nhạc nữ hàng đầu của K-Pop thế hệ mới.</p>
        </div>
        
        <div class="members">
          <div class="member-card">
            <div class="member-img">
              <img src="images/yunah.jpg" alt="Yunah">
            </div>
            <div class="member-info">
              <h3>Yunah</h3>
              <div class="position">Main Dancer, Lead Vocalist</div>
              <div class="country">🇰🇷</div>
              <div class="birthdate">15/01/2004</div>
            </div>
          </div>
          
          <div class="member-card">
            <div class="member-img">
              <img src="images/minju.jpg" alt="Minju">
            </div>
            <div class="member-info">
              <h3>Minju</h3>
              <div class="position">Main Vocalist, Lead Rapper, Dancer, Center</div>
              <div class="country">🇰🇷</div>
              <div class="birthdate">11/05/2004</div>
            </div>
          </div>
          
          <div class="member-card">
            <div class="member-img">
              <img src="images/moka.jpg" alt="Moka">
            </div>
            <div class="member-info">
              <h3>Moka</h3>
              <div class="position">Lead Dancer, Main Rapper, Visual</div>
              <div class="country">🇯🇵</div>
              <div class="birthdate">08/10/2004</div>
            </div>
          </div>
          
          <div class="member-card">
            <div class="member-img">
              <img src="images/wonhee.jpg" alt="Wonhee">
            </div>
            <div class="member-info">
              <h3>Wonhee</h3>
              <div class="position">Lead Vocalist, Face of the group, Center</div>
              <div class="country">🇰🇷</div>
              <div class="birthdate">26/06/2007</div>
            </div>
          </div>
          
          <div class="member-card">
            <div class="member-img">
              <img src="images/iroha.jpg" alt="Iroha">
            </div>
            <div class="member-info">
              <h3>Iroha</h3>
              <div class="position">Main Dancer, Main Vocalist, Maknae</div>
              <div class="country">🇯🇵</div>
              <div class="birthdate">04/02/2008</div>
            </div>
          </div>
        </div>
        
        <div class="designer-info">
          <h2>Tác giả thiết kế</h2>
          <p>Haruto Kairi (Tiktok: chieunguyen2002)</p>
          <p>Thiết kế trình phát nhạc ILLIT</p>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script>
    // Khởi tạo hiệu ứng hạt
    particlesJS("particles-js", {
      "particles": {
        "number": {
          "value": 80,
          "density": {
            "enable": true,
            "value_area": 800
          }
        },
        "color": {
          "value": "#ffffff"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#000000"
          },
          "polygon": {
            "nb_sides": 5
          }
        },
        "opacity": {
          "value": 0.3,
          "random": true,
          "anim": {
            "enable": true,
            "speed": 1,
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 3,
          "random": true,
          "anim": {
            "enable": true,
            "speed": 2,
            "size_min": 0.1,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": "#ffffff",
          "opacity": 0.2,
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 1,
          "direction": "none",
          "random": true,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": true,
            "mode": "grab"
          },
          "onclick": {
            "enable": true,
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 140,
            "line_linked": {
              "opacity": 1
            }
          },
          "push": {
            "particles_nb": 4
          }
        }
      },
      "retina_detect": true
    });
    
    // Tab switching
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Remove active class from all buttons and contents
        tabBtns.forEach(b => b.classList.remove('active'));
        tabContents.forEach(c => c.classList.remove('active'));
        
        // Add active class to clicked button and corresponding content
        btn.classList.add('active');
        const tabId = btn.getAttribute('data-tab');
        document.getElementById(`${tabId}-tab`).classList.add('active');
      });
    });
    
 
    // Clear cache and reload button
    const clearCacheBtn = document.createElement('i');
    clearCacheBtn.classList.add('material-icons');
    clearCacheBtn.textContent = 'refresh';
    clearCacheBtn.style.position = 'fixed';
    clearCacheBtn.style.bottom = '20px';
    clearCacheBtn.style.right = '20px';
    clearCacheBtn.style.fontSize = '32px';
    clearCacheBtn.style.cursor = 'pointer';
    clearCacheBtn.style.color = '#ff6ec4';
    clearCacheBtn.addEventListener('click', async () => {
      if ('caches' in window) {
        const cacheNames = await caches.keys();
        await Promise.all(cacheNames.map(name => caches.delete(name)));
      }
      location.reload(true);
    });
    document.body.appendChild(clearCacheBtn);
    
    // ============= PWA FEATURES =============
    
    // 1. Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(registration => {
            console.log('Service Worker registered with scope:', registration.scope);
          })
          .catch(error => {
            console.error('Service Worker registration failed:', error);
          });
      });
    }
    
    // 2. Install Button
    const installButton = document.getElementById('install-btn');
    let deferredPrompt;
    
    window.addEventListener('beforeinstallprompt', (e) => {
      // Ngăn trình duyệt tự động hiển thị prompt
      e.preventDefault();
      
      // Lưu sự kiện để có thể kích hoạt sau
      deferredPrompt = e;
      
      // Hiển thị nút cài đặt
      installButton.style.display = 'block';
    });
    
    installButton.addEventListener('click', () => {
      if (deferredPrompt) {
        // Hiển thị prompt cài đặt
        deferredPrompt.prompt();
        
        // Xử lý kết quả
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('Người dùng chấp nhận cài đặt');
          } else {
            console.log('Người dùng từ chối cài đặt');
          }
          
          // Xóa sự kiện sau khi đã sử dụng
          deferredPrompt = null;
          
          // Ẩn nút cài đặt
          installButton.style.display = 'none';
        });
      }
    });
    
    // 3. iOS PWA Splash Screen
    const iosSplash = document.getElementById('ios-splash');
    
    // Kiểm tra nếu là iOS và ở chế độ standalone (đã thêm vào màn hình chính)
    const isIOS = () => {
      const userAgent = window.navigator.userAgent.toLowerCase();
      return /iphone|ipad|ipod/.test(userAgent);
    };
    
    const isInStandaloneMode = () => ('standalone' in window.navigator) && window.navigator.standalone;
    
    // Xử lý splash screen cho iOS
    if (isIOS() && isInStandaloneMode()) {
      // Đã được thêm vào màn hình chính - ẩn splash sau 2s
      setTimeout(() => {
        iosSplash.classList.add('hidden');
      }, 2000);
    } else if (isIOS()) {
      // Chưa thêm vào màn hình chính - hiển thị splash và hướng dẫn thêm
      iosSplash.addEventListener('click', () => {
        iosSplash.classList.add('hidden');
      });
    } else {
      // Không phải iOS - ẩn splash
      iosSplash.classList.add('hidden');
    }
    
    // 4. Xử lý phát nhạc trong chế độ PWA iOS
    // iOS yêu cầu tương tác người dùng trước khi phát nhạc
    document.addEventListener('click', initAudioContext, { once: true });
    
    function initAudioContext() {
      // Tạo một context âm thanh ngắn để kích hoạt phát nhạc
      const silentAudio = new Audio();
      silentAudio.src = 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAA';
      silentAudio.play().catch(e => console.log('Silent audio play error', e));
      
      // Kích hoạt phát nhạc thật sau khi đã có tương tác
      if (audio) {
        audio.play().catch(e => console.log('Audio play error', e));
      }
    }
    
    // 5. Xử lý khi ứng dụng được khởi chạy từ màn hình chính
    window.addEventListener('load', () => {
      if (isInStandaloneMode()) {
        console.log('Ứng dụng đang chạy ở chế độ PWA');
        // Có thể thực hiện các hành động đặc biệt khi chạy ở chế độ PWA
      }
    });
    
    // ============= END PWA FEATURES =============
  </script>

  <!-- Service Worker Script (Inline) -->
  <script>
    // Tạo service worker động
    if ('serviceWorker' in navigator) {
      const swScript = `
        const CACHE_NAME = 'illit-music-player-v1';
        const urlsToCache = [
          '/',
          '/index.html',
          './js/music-list.js',
          './js/script.js',
          './logo.svg',
          'images/yunah.jpg',
          'images/minju.jpg',
          'images/moka.jpg',
          'images/wonhee.jpg',
          'images/iroha.jpg'
        ];
        
        self.addEventListener('install', event => {
          event.waitUntil(
            caches.open(CACHE_NAME)
              .then(cache => {
                return cache.addAll(urlsToCache);
              })
          );
        });
        
        self.addEventListener('fetch', event => {
          event.respondWith(
            caches.match(event.request)
              .then(response => {
                if (response) {
                  return response;
                }
                return fetch(event.request);
              })
          );
        });
        
        self.addEventListener('activate', event => {
          const cacheWhitelist = [CACHE_NAME];
          event.waitUntil(
            caches.keys().then(cacheNames => {
              return Promise.all(
                cacheNames.map(cacheName => {
                  if (cacheWhitelist.indexOf(cacheName) === -1) {
                    return caches.delete(cacheName);
                  }
                })
              );
            })
          );
        });
      `;
      
      const blob = new Blob([swScript], {type: 'application/javascript'});
      const swUrl = URL.createObjectURL(blob);
      
      navigator.serviceWorker.register(swUrl)
        .then(registration => {
          console.log('Dynamic Service Worker registered with scope:', registration.scope);
        })
        .catch(error => {
          console.error('Dynamic Service Worker registration failed:', error);
        });
    }
  </script>

  <script src="./js/music-list.js"></script>
  <script src="./js/script.js"></script>
</body>
</html>
